"0",""
"0","train_sgd <- function(X, y, loss_type = ""logistic"", lr = 0.01, epochs = 100) {"
"0","  n <- nrow(X)"
"0","  p <- ncol(X)"
"0","  theta <- rep(0, p)"
"0","  loss_history <- numeric(epochs)"
"0","  "
"0","  for (epoch in 1:epochs) {"
"0","    for (i in 1:n) {"
"0","      xi <- X[i, , drop = FALSE]"
"0","      yi <- y[i]"
"0","      score <- as.numeric(xi %*% theta)"
"0","      "
"0","      if (loss_type == ""logistic"") {"
"0","        grad <- as.numeric(-yi * xi / (1 + exp(yi * score)))"
"0","      } else if (loss_type == ""cross-entropy"") {"
"0","        prob <- 1 / (1 + exp(-score))"
"0","        grad <- as.numeric((prob - yi) * xi)"
"0","      }"
"0","      "
"0","      theta <- theta - lr * grad"
"0","    }"
"0","    "
"0","  "
"0","    probs <- 1 / (1 + exp(-X %*% theta))"
"0","    if (loss_type == ""logistic"") {"
"0","      loss_history[epoch] <- mean(log(1 + exp(-y * (X %*% theta))))"
"0","    } else if (loss_type == ""cross-entropy"") {"
"0","      eps <- 1e-6"
"0","      loss_history[epoch] <- -mean(y * log(probs + eps) + (1 - y) * log(1 - probs + eps))"
"0","    }"
"0","  }"
"0","  "
"0","  list(theta = theta, loss_history = loss_history)"
"0","}"
